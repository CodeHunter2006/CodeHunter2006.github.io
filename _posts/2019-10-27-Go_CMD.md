---
layout: post
title: "Go 常用命令"
date: 2019-10-27 16:00:00 +0800
tags: Go
---

记录 Go 配套的常用命令。

# go build

编译

- `-mod=vendor` build 时优先使用 vendor 中的依赖包

- `-race`
  增加 data race detector 功能，在程序执行过程中会分析共享变量和锁的执行过程，分析是否存在 data race，并生成报告以便定位问题。在运行时，如果发现 data race，则会输出`WARNING: DATA RACE xxxx`，同时输出涉及的携程的栈。

- 如果包名是`main`，执行`go build`时会自动找到并编译，会编译为二进制文件放在当前包内
- 如果包名不是`main`，执行`go build`会找不到，需要执行`go build xxx.go`，会尝试编译，成功后丢弃编译出的二进制文件，如果想生成二进制文件需要用`-o name`执行二进制文件名

可以通过下面环境变量设置交叉编译选项:

```
// 示例，在 windows 下编译 mac 使用的可执行文件
SET CGO_ENABLED = 0
SET GOOS = darwin3
SET GOARCH = amd64
go build test.go
```

`GOOS=linux GOARCH=amd64 go build main.go`

- CGO_ENABLED 是否启用 CGO，0 不启用; 1 启用;
- GOOS 目标操作系统，windows linux darwin freebsd，其中 darwin 是 mac 的操作系统
- GOARCH 目标操作系统架构，386 amd64 arm

# go run

编译并运行

`go run hello.go`

# go mod

`go mod vendor`
更新本工程的依赖库到本地 vendor 文件夹，不指定特定版本的外部包
